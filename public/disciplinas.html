<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedStudios - Disciplinas</title>
    <link rel="stylesheet" href="/styles/main.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>MedStudios</h1>
        </div>

        <nav class="nav">
            <ul>
                <li><a href="/">🏠 Início</a></li>
                <li><a href="/cronograma.html">📅 Cronograma</a></li>
                <li><a href="/agenda.html">📝 Agenda</a></li>
                <li><a href="/planejamento.html">📚 Planejamento</a></li>
                <li><a href="/progresso.html">📊 Progresso</a></li>
                <li><a href="/disciplinas.html" class="active">📖 Disciplinas</a></li>
                <li><a href="/professores.html">👨‍🏫 Professores</a></li>
                <li><a href="/semestre.html">🗓️ Semestre</a></li>
            </ul>
        </nav>

        <div class="card text-center mb-30">
            <h2>📖 Disciplinas</h2>
            <p>Gerencie suas disciplinas e acompanhe seu progresso acadêmico</p>
        </div>

        <!-- Botão Adicionar -->
        <div class="mb-20">
            <button class="btn btn--primary" onclick="showAddForm()">+ Adicionar Nova Disciplina</button>
        </div>

        <!-- Formulário de Adicionar/Editar -->
        <div id="disciplineForm" class="card mb-30" style="display: none;">
            <h3 id="formTitle">Adicionar Nova Disciplina</h3>
            <form id="disciplineFormElement">
                <input type="hidden" id="disciplineId">
                <div class="grid grid--2">
                    <div class="form-group">
                        <label for="disciplineName">Nome da Disciplina</label>
                        <input type="text" id="disciplineName" required>
                    </div>
                    <div class="form-group">
                        <label for="disciplineCode">Código</label>
                        <input type="text" id="disciplineCode" required>
                    </div>
                    <div class="form-group">
                        <label for="disciplineCredits">Créditos</label>
                        <input type="number" id="disciplineCredits" min="1" max="10" required>
                    </div>
                    <div class="form-group">
                        <label for="disciplineProfessor">Professor</label>
                        <input type="text" id="disciplineProfessor" required>
                    </div>
                    <div class="form-group">
                        <label for="disciplineSchedule">Horário</label>
                        <input type="text" id="disciplineSchedule" placeholder="Ex: Seg/Qua 08:00-10:00" required>
                    </div>
                    <div class="form-group">
                        <label for="disciplineGrade">Nota Atual</label>
                        <input type="number" id="disciplineGrade" min="0" max="10" step="0.1">
                    </div>
                </div>
                <div class="form-group">
                    <label for="disciplineProgress">Progresso (%)</label>
                    <input type="range" id="disciplineProgress" min="0" max="100" value="0" oninput="updateProgressValue(this.value)">
                    <span id="progressValue">0%</span>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit" class="btn btn--primary">Salvar</button>
                    <button type="button" class="btn btn--secondary" onclick="hideForm()">Cancelar</button>
                </div>
            </form>
        </div>

        <!-- Lista de Disciplinas -->
        <div class="grid grid--2" id="disciplinesGrid">
            <!-- Disciplinas serão carregadas dinamicamente -->
        </div>
    </div>

    <script>
        // Dados das disciplinas (posteriormente virão do backend)
        let disciplinesData = [
            {
                id: 1,
                name: "Anatomia Humana",
                code: "MED101",
                credits: 6,
                professor: "Dr. Silva",
                schedule: "Seg/Qua 08:00-10:00",
                progress: 75,
                grade: 8.5
            },
            {
                id: 2,
                name: "Fisiologia",
                code: "MED102",
                credits: 4,
                professor: "Dra. Santos",
                schedule: "Ter/Qui 14:00-16:00",
                progress: 60,
                grade: 7.8
            },
            {
                id: 3,
                name: "Bioquímica",
                code: "MED103",
                credits: 4,
                professor: "Dr. Costa",
                schedule: "Sex 08:00-12:00",
                progress: 45,
                grade: 8.2
            },
            {
                id: 4,
                name: "Histologia",
                code: "MED104",
                credits: 3,
                professor: "Dra. Lima",
                schedule: "Seg 14:00-17:00",
                progress: 80,
                grade: 9.1
            }
        ];

        let nextId = 5;

        function loadDisciplines() {
            const grid = document.getElementById('disciplinesGrid');
            grid.innerHTML = '';
            
            disciplinesData.forEach(discipline => {
                const card = document.createElement('div');
                card.className = 'card';
                
                // Determinar cor do card baseado na nota
                let cardClass = '';
                if (discipline.grade >= 9) cardClass = 'card--success';
                else if (discipline.grade >= 7) cardClass = '';
                else if (discipline.grade >= 5) cardClass = 'card--warning';
                else cardClass = 'card--danger';
                
                card.className += ' ' + cardClass;
                
                card.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                        <div>
                            <h3 style="margin-bottom: 5px;">${discipline.name}</h3>
                            <p style="color: var(--text-gray); font-size: 0.9rem;">${discipline.code}</p>
                        </div>
                        <span style="background-color: var(--primary-blue); color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.8rem;">
                            ${discipline.credits} créditos
                        </span>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="color: var(--text-gray);">Professor:</span>
                            <span style="font-weight: 500;">${discipline.professor}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="color: var(--text-gray);">Horário:</span>
                            <span style="font-weight: 500;">${discipline.schedule}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span style="color: var(--text-gray);">Nota Atual:</span>
                            <span style="font-weight: 500; color: ${discipline.grade >= 7 ? 'var(--success-green)' : discipline.grade >= 5 ? 'var(--warning-orange)' : 'var(--danger-red)'};">                                ${discipline.grade}
                            </span>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="color: var(--text-gray); font-size: 0.9rem;">Progresso</span>
                            <span style="font-size: 0.9rem; font-weight: 500;">${discipline.progress}%</span>
                        </div>
                        <div style="width: 100%; height: 8px; background-color: #e5e7eb; border-radius: 10px; overflow: hidden;">
                            <div style="height: 100%; background-color: var(--success-green); width: ${discipline.progress}%; transition: width 0.3s ease;"></div>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn--primary" onclick="editDiscipline(${discipline.id})" style="flex: 1;">Editar</button>
                        <button class="btn btn--danger" onclick="deleteDiscipline(${discipline.id})" style="flex: 1;">Excluir</button>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function showAddForm() {
            document.getElementById('formTitle').textContent = 'Adicionar Nova Disciplina';
            document.getElementById('disciplineFormElement').reset();
            document.getElementById('disciplineId').value = '';
            document.getElementById('disciplineForm').style.display = 'block';
            updateProgressValue(0);
        }

        function editDiscipline(id) {
            const discipline = disciplinesData.find(d => d.id === id);
            if (discipline) {
                document.getElementById('formTitle').textContent = 'Editar Disciplina';
                document.getElementById('disciplineId').value = discipline.id;
                document.getElementById('disciplineName').value = discipline.name;
                document.getElementById('disciplineCode').value = discipline.code;
                document.getElementById('disciplineCredits').value = discipline.credits;
                document.getElementById('disciplineProfessor').value = discipline.professor;
                document.getElementById('disciplineSchedule').value = discipline.schedule;
                document.getElementById('disciplineGrade').value = discipline.grade;
                document.getElementById('disciplineProgress').value = discipline.progress;
                updateProgressValue(discipline.progress);
                document.getElementById('disciplineForm').style.display = 'block';
            }
        }

        function deleteDiscipline(id) {
            if (confirm('Tem certeza que deseja excluir esta disciplina?')) {
                disciplinesData = disciplinesData.filter(d => d.id !== id);
                loadDisciplines();
                // Aqui seria feita a chamada para a API para deletar no backend
                // await fetch(`/api/disciplines/${id}`, { method: 'DELETE' });
            }
        }

        function hideForm() {
            document.getElementById('disciplineForm').style.display = 'none';
        }

        function updateProgressValue(value) {
            document.getElementById('progressValue').textContent = value + '%';
        }

        // Manipular envio do formulário
        document.getElementById('disciplineFormElement').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const id = document.getElementById('disciplineId').value;
            const disciplineData = {
                name: document.getElementById('disciplineName').value,
                code: document.getElementById('disciplineCode').value,
                credits: parseInt(document.getElementById('disciplineCredits').value),
                professor: document.getElementById('disciplineProfessor').value,
                schedule: document.getElementById('disciplineSchedule').value,
                grade: parseFloat(document.getElementById('disciplineGrade').value) || 0,
                progress: parseInt(document.getElementById('disciplineProgress').value)
            };
            
            if (id) {
                // Editar disciplina existente
                const index = disciplinesData.findIndex(d => d.id === parseInt(id));
                if (index !== -1) {
                    disciplinesData[index] = { ...disciplineData, id: parseInt(id) };
                }
                // Aqui seria feita a chamada para a API para atualizar no backend
                // await fetch(`/api/disciplines/${id}`, { method: 'PUT', body: JSON.stringify(disciplineData) });
            } else {
                // Adicionar nova disciplina
                disciplineData.id = nextId++;
                disciplinesData.push(disciplineData);
                // Aqui seria feita a chamada para a API para criar no backend
                // await fetch('/api/disciplines', { method: 'POST', body: JSON.stringify(disciplineData) });
            }
            
            hideForm();
            loadDisciplines();
        });

        // Carregar disciplinas quando a página carregar
        document.addEventListener('DOMContentLoaded', loadDisciplines);
    </script>
</body>
</html>