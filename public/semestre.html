<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Semestre - MedStudios</title>
    <link rel="stylesheet" href="main.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .semester-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-label {
            font-weight: 600;
            color: #555;
        }

        .info-value {
            color: var(--primary-color);
            font-weight: 500;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            text-align: center;
            margin-top: 20px;
        }

        .calendar-day {
            padding: 10px;
            border-radius: 5px;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .calendar-header {
            font-weight: bold;
            color: var(--primary-color);
            background: #f8f9ff;
        }

        .calendar-current {
            background: var(--primary-color);
            color: white;
        }

        .calendar-event {
            background: #ffe6e6;
            color: #d63384;
            cursor: pointer;
        }

        .calendar-event:hover {
            background: #ffcccc;
            transform: scale(1.05);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: #f8f9ff;
            border-radius: 10px;
            border: 2px solid #e0e6ff;
        }

        .stat-number {
            font-size: 1.8em;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <nav class="navbar">
            <div class="nav-brand">
                <h2>MedStudios</h2>
            </div>
            <div class="nav-links">
                <a href="/">Dashboard</a>
                <a href="/cronograma.html">Cronograma</a>
                <a href="/agenda.html">Agenda</a>
                <a href="/disciplinas.html">Disciplinas</a>
                <a href="/professores.html">Professores</a>
                <a href="/semestre.html" class="active">Semestre</a>
                <a href="/progresso.html">Progresso</a>
                <a href="/planejamento.html">Planejamento</a>
            </div>
        </nav>

        <div class="main-content">
            <div class="card title-card">
                <h1>üìÖ 2¬∫ Semestre - Medicina</h1>
                <p>Vis√£o geral do semestre acad√™mico atual</p>
            </div>

            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number" id="semanas-concluidas">8</div>
                    <div class="stat-label">Semanas Conclu√≠das</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="total-disciplinas">6</div>
                    <div class="stat-label">Disciplinas</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="media-semestre">8.5</div>
                    <div class="stat-label">M√©dia Geral</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="frequencia-semestre">95%</div>
                    <div class="stat-label">Frequ√™ncia</div>
                </div>
            </div>
            
            <div class="semester-info">
                <div class="card">
                    <h3>üìã Informa√ß√µes Gerais</h3>
                    <div class="info-item">
                        <span class="info-label">Per√≠odo:</span>
                        <span class="info-value">2¬∫ Semestre 2024</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">In√≠cio:</span>
                        <span class="info-value">01/08/2024</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">T√©rmino:</span>
                        <span class="info-value">15/12/2024</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Dura√ß√£o:</span>
                        <span class="info-value">20 semanas</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Status:</span>
                        <span class="info-value">Em Andamento</span>
                    </div>
                </div>

                <div class="card">
                    <h3>üìä Progresso do Semestre</h3>
                    <div class="info-item">
                        <span class="info-label">Semanas Conclu√≠das:</span>
                        <span class="info-value">8 de 20</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 40%;"></div>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Progresso:</span>
                        <span class="info-value">40% Conclu√≠do</span>
                    </div>
                </div>

                <div class="card">
                    <h3>üìö Disciplinas do Semestre</h3>
                    <div id="disciplinas-list">
                        <!-- Disciplinas ser√£o carregadas dinamicamente -->
                    </div>
                </div>

                <div class="card">
                    <h3>üìù Pr√≥ximas Avalia√ß√µes</h3>
                    <div id="avaliacoes-list">
                        <!-- Avalia√ß√µes ser√£o carregadas dinamicamente -->
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>üìÖ Calend√°rio - Novembro 2024</h3>
                <div class="calendar-grid" id="calendar-grid">
                    <!-- Calend√°rio ser√° gerado dinamicamente -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Substituir dados est√°ticos por chamadas de API
        async function loadSemesterData() {
            try {
                // Carregar disciplinas
                const subjectsResponse = await fetch('/api/subjects');
                if (subjectsResponse.ok) {
                    const subjects = await subjectsResponse.json();
                    renderSubjects(subjects);
                }
                
                // Carregar cronograma
                const scheduleResponse = await fetch('/api/schedule');
                if (scheduleResponse.ok) {
                    const schedule = await scheduleResponse.json();
                    renderSchedule(schedule);
                }
            } catch (error) {
                console.error('Erro ao carregar dados do semestre:', error);
                // Fallback para dados est√°ticos
            }
        }

        // Carregar avalia√ß√µes da API
        async function loadEvaluations() {
            try {
                const response = await fetch('/api/tasks?type=evaluation');
                if (response.ok) {
                    const evaluations = await response.json();
                    const container = document.getElementById('avaliacoes-list');
                    container.innerHTML = '';

                    if (evaluations.length === 0) {
                        container.innerHTML = '<div class="info-item"><span>Nenhuma avalia√ß√£o pr√≥xima</span></div>';
                        return;
                    }

                    evaluations.slice(0, 4).forEach(evaluation => {
                        const dueDate = new Date(evaluation.dueDate).toLocaleDateString('pt-BR');
                        const item = document.createElement('div');
                        item.className = 'info-item';
                        item.innerHTML = `
                            <span class="info-label">${evaluation.subject || 'Disciplina'} - ${evaluation.title}:</span>
                            <span class="info-value">${dueDate}</span>
                        `;
                        container.appendChild(item);
                    });
                } else {
                    throw new Error('API n√£o dispon√≠vel');
                }
            } catch (error) {
                console.log('Usando dados est√°ticos para avalia√ß√µes');
                const container = document.getElementById('avaliacoes-list');
                container.innerHTML = '';
                semesterData.evaluations.forEach(evaluation => {
                    const item = document.createElement('div');
                    item.className = 'info-item';
                    item.innerHTML = `
                        <span class="info-label">${evaluation.subject} - ${evaluation.type}:</span>
                        <span class="info-value">${evaluation.date}</span>
                    `;
                    container.appendChild(item);
                });
            }
        }

        // Atualizar inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            loadSubjects();
            loadEvaluations();
            generateCalendar();
        });
    </script>
</body>
</html>